#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ” Running pre-commit checks..."

# ĞŸĞµÑ€ĞµĞ¹Ñ‚Ğ¸ Ğ² frontend Ğ¿Ğ°Ğ¿ĞºÑƒ
cd frontend

echo "ğŸ“ Checking file sizes (max 100 lines per file)..."
# ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ñ€Ğ°Ğ·Ğ¼ĞµÑ€Ğ° Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ² (Ğ¸ÑĞºĞ»ÑÑ‡Ğ°ĞµĞ¼ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³Ğ¸ Ğ¸ Ñ‚ĞµÑÑ‚Ñ‹)
large_files=$(find . -name "*.ts" -o -name "*.tsx" \
  | grep -v node_modules \
  | grep -v ".next" \
  | grep -v ".test." \
  | grep -v ".stories." \
  | grep -v "config" \
  | grep -v "types/" \
  | xargs wc -l \
  | awk '$1 > 100 && $2 != "total"' \
  | head -10)

if [ -n "$large_files" ]; then
  echo "âŒ Files exceed 100 lines limit:"
  echo "$large_files"
  echo "Please split large files into smaller modules"
  exit 1
fi

echo "ğŸ“ Running ESLint..."
npm run lint

echo "ğŸ”§ Running TypeScript type check..."
npm run type-check

echo "ğŸ§ª Running tests..."
npm run test -- --passWithNoTests

echo "âœ… All pre-commit checks passed!"
